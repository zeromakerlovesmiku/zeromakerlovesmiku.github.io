<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="Existentialism is a Humanism">
<meta property="og:type" content="website">
<meta property="og:title" content="Zeromaker&#39;s Blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Zeromaker&#39;s Blog">
<meta property="og:description" content="Existentialism is a Humanism">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Zeromaker&#39;s Blog">
<meta name="twitter:description" content="Existentialism is a Humanism">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title>Zeromaker's Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Zeromaker's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/23/Lab6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zeromaker">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/author5.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zeromaker's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/23/Lab6/" itemprop="url">Lab6</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-06-23T23:29:34+08:00">
                2019-06-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="软件构造Lab6总结"><a href="#软件构造Lab6总结" class="headerlink" title="软件构造Lab6总结"></a>软件构造Lab6总结</h1><hr>
<p>软件构造lab6主要需要完成如下任务</p>
<blockquote>
<ul>
<li>面向多线程的ADT开发</li>
<li>多线程任务“猴子过河”</li>
</ul>
</blockquote>
<hr>
<h2 id="多线程安全的ADT开发"><a href="#多线程安全的ADT开发" class="headerlink" title="多线程安全的ADT开发"></a>多线程安全的ADT开发</h2><ol>
<li>Monkey<br>a)    作用：存储猴子所需的全部状态，并执行过河过程<br>b)    属性：<br>i.    Id：猴子的唯一标识<br>ii.    Bornside：出生地<br>iii.    Direction：方向<br>iv.    Borntime：出生时间<br>v.    Arrivetime：到达时间<br>vi.    Ladderid：选择的梯子id<br>vii.    Rungnumber：猴子当前在梯子的第几阶梯<br>viii.    Speed：速度<br>c)    方法<br>i.    Run方法，执行猴子过河过程</li>
<li>Ladder<br>a)    作用：存储梯子的全部状态<br>b)    属性<br>i.    Ladderid：梯子唯一标识<br>ii.    Rungnumber：梯子的台阶数量<br>iii.    Rungs：每个台阶上猴子的情况</li>
</ol>
<h2 id="多线程任务“猴子过河”"><a href="#多线程任务“猴子过河”" class="headerlink" title="多线程任务“猴子过河”"></a>多线程任务“猴子过河”</h2><h3 id="猴子过河的策略实现"><a href="#猴子过河的策略实现" class="headerlink" title="猴子过河的策略实现"></a>猴子过河的策略实现</h3><p>策略1<br>猴子首先优先选择空梯子，若没有空梯子，则在所有的梯子当中随机选择一个</p>
<p>策略2<br>按照猴子自身的速度和速度上限MV，将猴子分为低速猴子（&lt;MV/10），高速猴子（&gt;MV*9/10）和一般猴子（其他），分别采取不同策略<br>对于高速猴子，优先选择梯子上第一个猴子距离自己最远的梯子，如果梯子为空，则这个距离设置为无穷远<br>对于低速猴子，不抢占空梯子，并且优先选择梯子上第一个猴子距离自己近的梯子<br>对于一般速度的猴子，选择梯子真实行进速度和自己最接近的梯子</p>
<h2 id="“猴子生成器”MonkeyGenerator"><a href="#“猴子生成器”MonkeyGenerator" class="headerlink" title="“猴子生成器”MonkeyGenerator"></a>“猴子生成器”MonkeyGenerator</h2><p>设计一个timer，每隔t秒发射一个timertask进程，又timertask进行猴子生成和进程启动功能，timertask内容如下<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">TimerTask task = <span class="keyword">new</span> TimerTask() &#123;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">//System.out.println("Timer"+String.valueOf(current)+" is start");</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;Monkeycontainer.monkeys().size();i++) &#123;</span><br><span class="line"><span class="keyword">if</span> (running.contains(i)) &#123;</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line">Monkey now = Monkeycontainer.monkeys().get(i);</span><br><span class="line"><span class="keyword">if</span> (now.borntime()==current*<span class="number">1000</span>) &#123;</span><br><span class="line">running.add(i);</span><br><span class="line">hasrun++;</span><br><span class="line">Thread monkeyThread = <span class="keyword">new</span> Thread(now);</span><br><span class="line">monkeyThread.start();</span><br><span class="line">Threadpool.add(monkeyThread);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (hasrun==Monkeycontainer.monkeys().size()) &#123;</span><br><span class="line">callback(Monkeycontainer.monkeys().size());</span><br><span class="line">timer.cancel();</span><br><span class="line">&#125;</span><br><span class="line">current++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<h2 id="确保threadsafe的策略"><a href="#确保threadsafe的策略" class="headerlink" title="确保threadsafe的策略"></a>确保threadsafe的策略</h2><p>Ladder中，所有的list等线程不安全的数据结构都使用了线程安全的版本<br>Monkey中的run方法，在某个猴子选择梯子时，手动给进程上锁，保证其他不回切换到其他进程，在猴子移动、走下梯子时，也采用同样的方法，保证了线程安全</p>
<h2 id="吞吐率和公平性计算"><a href="#吞吐率和公平性计算" class="headerlink" title="吞吐率和公平性计算"></a>吞吐率和公平性计算</h2><p>在callback函数中，通过开始启动猴子生成器的时间和调用回调函数时的时间的差，可以计算出所用的总时间，之后可以计算出系统的吞吐率<br>之后，遍历每一只猴子，由于猴子到达目的地之后都会记录自己的arrivetime，通过比较任意两只猴子之间出生时间和到达时间的情况，即可计算出公平性<br>callback函数设计如下<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">callback</span><span class="params">(<span class="keyword">int</span> N)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (Thread i : Threadpool) &#123;</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">i.join();</span><br><span class="line">&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">long</span> now = Instant.now().toEpochMilli();</span><br><span class="line"><span class="keyword">double</span> inoutrate = N*<span class="number">1000.0</span>/((<span class="keyword">double</span>)now-start);</span><br><span class="line">System.out.println(now);</span><br><span class="line">System.out.println(start);</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> fair=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> limit = Monkeycontainer.monkeys().size();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;limit;i++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;limit;j++) &#123;</span><br><span class="line"><span class="keyword">boolean</span> sigborn=Monkeycontainer.monkeys().get(i).borntime()&lt;Monkeycontainer.monkeys().get(j).borntime();</span><br><span class="line"><span class="keyword">boolean</span> sigarr=Monkeycontainer.monkeys().get(i).arrivetime()&lt;Monkeycontainer.monkeys().get(j).arrivetime();</span><br><span class="line"><span class="keyword">if</span> ((sigborn &amp;&amp; sigarr) || ((!sigborn) &amp;&amp; (!sigarr))) &#123;</span><br><span class="line">fair = fair+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">fair = fair-<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">Logger log = Logger.getLogger(<span class="string">"Monkeylog"</span>);</span><br><span class="line">log.setLevel(Level.INFO);</span><br><span class="line">log.setUseParentHandlers(<span class="keyword">true</span>);</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">String thePath = System.getProperty(<span class="string">"user.dir"</span>);</span><br><span class="line">String fileSeperator = File.separator;</span><br><span class="line">thePath = thePath + fileSeperator + <span class="string">"log"</span></span><br><span class="line">+ fileSeperator;</span><br><span class="line">FileHandler fileHandler = <span class="keyword">new</span> FileHandler(</span><br><span class="line">thePath + <span class="string">"Monkey.log"</span>);</span><br><span class="line">fileHandler.setLevel(Level.INFO);</span><br><span class="line">log.addHandler(fileHandler);</span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">System.err.println(<span class="string">"Log directory doesn't exsit."</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (String i : Monkeycontainer.loglist()) &#123;</span><br><span class="line">log.info(i);</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(<span class="string">"INOUTRATE:"</span>);</span><br><span class="line">System.out.println(inoutrate);</span><br><span class="line">System.out.println(<span class="string">"Fairness:"</span>);</span><br><span class="line">System.out.println(fair/(N * (N - <span class="number">1</span>) / <span class="number">2.0</span>));</span><br><span class="line">Gui.draw();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="猴子过河策略效率，参数对吞吐率的影响等"><a href="#猴子过河策略效率，参数对吞吐率的影响等" class="headerlink" title="猴子过河策略效率，参数对吞吐率的影响等"></a>猴子过河策略效率，参数对吞吐率的影响等</h2><p>通过多次实验和作图的方式进行了详细比较，具体参见实验报告</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/23/Lab5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zeromaker">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/author5.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zeromaker's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/23/Lab5/" itemprop="url">Lab5</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-06-23T23:16:20+08:00">
                2019-06-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="软件构造Lab5总结"><a href="#软件构造Lab5总结" class="headerlink" title="软件构造Lab5总结"></a>软件构造Lab5总结</h1><hr>
<p>软件构造lab5主要需要在Lab4的基础上完成如下任务</p>
<blockquote>
<ul>
<li>静态代码检查</li>
<li>高性能IO</li>
<li>java 命令行工具和可视化工具对代码进行分析</li>
</ul>
</blockquote>
<hr>
<h2 id="CheckStyle"><a href="#CheckStyle" class="headerlink" title="CheckStyle"></a>CheckStyle</h2><p>3.1.1 人工代码走查（walkthrough）<br>发现的问题如下：</p>
<ol>
<li>双目运算符前后未加括号</li>
<li>For语句之后为加大括号</li>
<li>一行超过80字符<br>修改方式如下<br>1.双目运算符前后添加加号<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">thePath = thePath + fileSeperator + <span class="string">"src"</span> + fileSeperator + <span class="string">"log"</span></span><br><span class="line">+ fileSeperator;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>2.For语句之后添加括号<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (Person j : ans.nodelist()) &#123;</span><br><span class="line"><span class="keyword">if</span> (j.name().equals(i.getKey())) &#123;</span><br><span class="line">nowx = j;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>3.对行进行一定程度的分行<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">!commandLine.matches(<span class="string">"calcDistance\\s[a-zA-z]+\\s[a-zA-z]+\\s"</span></span><br><span class="line">+ <span class="string">"[a-zA-z]+\\"</span> + <span class="string">"s[0-9]\\d*\\.?\\d*\\s[0-9]\\d*\\.?\\d*"</span></span><br><span class="line">+ <span class="string">"\\s[0-9]\\"</span> + <span class="string">"d*\\.?\\d*\\s[CW|CW]+\\s[0-9]\\d*\\.?\\"</span></span><br><span class="line">+ <span class="string">"d*\\s[a-zA-z]+\\s[a-zA-z]+\\s[a-zA-z]+\\"</span></span><br><span class="line">+ <span class="string">"s[0-9]\\d*\\.?\\d*\\s[0-9]\\d*\\.?\\d*\\"</span></span><br><span class="line">+ <span class="string">"s[0-9]\\d*\\.?\\d*\\s[CW|CW]+\\s[0-9]\\d*"</span> + <span class="string">"\\.?\\d*"</span>)</span><br></pre></td></tr></table></figure></p>
<h2 id="高性能IO"><a href="#高性能IO" class="headerlink" title="高性能IO"></a>高性能IO</h2><h3 id="策略设计"><a href="#策略设计" class="headerlink" title="策略设计"></a>策略设计</h3><p>实现了如下三种IO方式：<br>Input:<br>BufferedReader方法，按行读<br>FileInputStream方法，全部装载入内存中<br>Files.readallBytes方法，全部装载入内存中</p>
<p>Output:<br>FileWriter方法，逐行写入<br>Bufferredwriter<br>FileOutputStream</p>
<h3 id="Strategy设计模式"><a href="#Strategy设计模式" class="headerlink" title="Strategy设计模式"></a>Strategy设计模式</h3><p>Strategy设计模式：<br>首先设计InputStrategy和OutputStrategy两个接口，定义针对三种类的I/O函数<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Inputstrategy</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> StellarSystem <span class="title">buildStellarSystemfromfile</span><span class="params">(<span class="keyword">final</span> String filePath)</span></span></span><br><span class="line"><span class="function"><span class="keyword">throws</span> FileNotFoundException, SameObjectException, GrammarErrorException,</span></span><br><span class="line"><span class="function">IOException</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> AtomStructure <span class="title">buildAtomStructurefromfile</span><span class="params">(<span class="keyword">final</span> String filePath)</span></span></span><br><span class="line"><span class="function"><span class="keyword">throws</span> FileNotFoundException, ContextErrorException,</span></span><br><span class="line"><span class="function">GrammarErrorException, IOException</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> SocialNetworkCircle <span class="title">buildASoicalNetworkfromfile</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="keyword">final</span> String filePath)</span> <span class="keyword">throws</span> FileNotFoundException, SelfLoopException,</span></span><br><span class="line"><span class="function">GrammarErrorException, IOException, SameObjectException</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OutputStrategy</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writeStellarSystemtofile</span><span class="params">(StellarSystem now)</span> <span class="keyword">throws</span> IOException</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writeAtomStructuretofile</span><span class="params">(AtomStructure now)</span> <span class="keyword">throws</span> IOException</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writeSocialNetworkCircletofile</span><span class="params">(SocialNetworkCircle now)</span></span></span><br><span class="line"><span class="function"><span class="keyword">throws</span> IOException</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>之后，设计两个Context类，Contextwriter和Contextreader，将上述I/OStrategy作为其filed, 定义如下<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Contextreader</span> </span>&#123;</span><br><span class="line">Inputstrategy reader;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Contextreader</span><span class="params">(Inputstrategy reader)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.reader = reader;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Inputstrategy <span class="title">reader</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> reader;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>之后即可自由切换读入模式</p>
<h2 id="代码动态分析"><a href="#代码动态分析" class="headerlink" title="代码动态分析"></a>代码动态分析</h2><p>主要使用JVM中的各种命令对代码进行调试、分析，查找性能瓶颈，分析GC流程等</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/23/Lab4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zeromaker">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/author5.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zeromaker's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/23/Lab4/" itemprop="url">Lab4</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-06-23T23:05:41+08:00">
                2019-06-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="软件构造Lab4总结"><a href="#软件构造Lab4总结" class="headerlink" title="软件构造Lab4总结"></a>软件构造Lab4总结</h1><hr>
<p>软件构造lab4主要需要在Lab3的基础上完成如下任务</p>
<blockquote>
<ul>
<li>静态代码检查</li>
<li>错误/异常处理</li>
<li>防御性编程</li>
<li>日志</li>
</ul>
</blockquote>
<hr>
<h2 id="Error-and-Exception-Handling"><a href="#Error-and-Exception-Handling" class="headerlink" title="Error and Exception Handling"></a>Error and Exception Handling</h2><p>对三个应用场景，分别设计了一些需要处理的异常，并在客户端程序client中捕获并处理</p>
<ol>
<li>StellarSystem<br>设计了三种异常：文件异常、相同元素异常和语法异常<br>文件异常<br>描述：用户输入的文件不存在或未找到<br>客户端处理方式：写入log，在控制台打印提示信息，要求重新输入命令，同时恢复待建立的StelllarSystem到初始状态</li>
</ol>
<p>相同元素异常<br>描述：用户输入的文件中含有相同的元素或相同的命令<br>客户端处理方式：写入log，在控制台打印提示信息，要求重新输入命令，同时恢复待建立的StelllarSystem到初始状态</p>
<p>语法异常<br>描述：用户输入文件中含有不符合语法规范的语句，具体设计了5种不符合规范的形式：<br>命令格式错误：命令未按照规定的格式，使用&lt;&gt;将命令主题扩起<br>对象拼写错误：对象拼写有误<br>参数数量错误：参数数量不对<br>分隔符错误：未使用,作为分隔符<br>致命错误：乱码或完全不符合语法规范<br>客户端处理方式：根据错误类型不同，写入不同的log信息，并根据错误类型提示用户可能存在的问题，同时恢复StelllarSystem</p>
<ol start="2">
<li>AtomStructure<br>设计了三种异常：文件异常，内容异常和语法异常<br>文件异常<br>描述：用户输入的文件不存在或未找到<br>客户端处理方式：写入log，在控制台打印提示信息，要求重新输入命令，同时恢复待建立的AtomStructure到初始状态</li>
</ol>
<p>内容异常<br>描述：AtomStructure文件中出现了两个原子核描述或两个电子轨道描述<br>客户端处理方式：写入log，在控制台打印提示信息，要求重新输入命令，同时恢复待建立的AtomStructure到初始状态</p>
<p>语法异常<br>描述：用户输入文件中含有不符合语法规范的语句，具体设计了5种不符合规范的形式：<br>命令格式错误：命令未按照规定的格式<br>对象拼写错误：对象拼写有误<br>参数类型错误：在电子轨道描述中，使用小数或非正整数描述轨道上的电子数量<br>分隔符错误：未使用;作为分隔符<br>致命错误：乱码或完全不符合语法规范<br>客户端处理方式：根据错误类型不同，写入不同的log信息，并根据错误类型提示用户可能存在的问题，同时恢复AtomStructure</p>
<ol start="3">
<li>SocialNetwork<br>设计了四种异常：文件异常，相同元素异常，自环异常和语法异常<br>文件异常<br>描述：用户输入的文件不存在或未找到<br>客户端处理方式：写入log，在控制台打印提示信息，要求重新输入命令，同时恢复待建立的SocialNetwork到初始状态</li>
</ol>
<p>相同元素异常<br>描述：用户输入的文件中含有相同的元素或相同的命令<br>客户端处理方式：写入log，在控制台打印提示信息，要求重新输入命令，同时恢复待建立的SocialNetwork到初始状态</p>
<p>自环异常<br>描述：用户输入中含有自己指向自己的边<br>客户端处理方式：写入log，在控制台打印提示信息，要求重新输入命令，同时恢复待建立的SocialNetwork到初始状态</p>
<p>语法异常<br>描述：用户输入文件中含有不符合语法规范的语句，具体设计了5种不符合规范的形式：<br>命令格式错误：命令未按照规定的格式，使用&lt;&gt;将命令主题扩起<br>对象拼写错误：对象拼写有误<br>参数数量错误：参数数量不对<br>分隔符错误：未使用,作为分隔符<br>致命错误：乱码或完全不符合语法规范<br>客户端处理方式：根据错误类型不同，写入不同的log信息，并根据错误类型提示用户可能存在的问题，同时恢复SocialNetwork</p>
<h2 id="Assertion-and-Defensive-Programming"><a href="#Assertion-and-Defensive-Programming" class="headerlink" title="Assertion and Defensive Programming"></a>Assertion and Defensive Programming</h2><h3 id="checkRep-检查invariants"><a href="#checkRep-检查invariants" class="headerlink" title="checkRep()检查invariants"></a>checkRep()检查invariants</h3><p>在实验3中，已经在所有具体应用程序的父类中实现了较为完善的checkRep()函数，这个函数自动被所有的应用程序所继承<br>所有应用程序的父类RI如下<br>Representation invariant:<br>All keys in relation, crealtion and belong should in nodelist<br>If relation.get(i).contains(j) then relation.get(j).contains(i). In another word, the relation Map represent a one-way relation, so you should keep the relation Symmetric<br>Each node should in the Keyset of crealtion, if the node i isn’t connected to the center, then crelation.get(i)==-1<br>the track that a object belong should have been added into the class before<br>chekRep如下<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">checkRep</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (E i : relation.keySet()) &#123;</span><br><span class="line"><span class="keyword">assert</span> nodelist.contains(i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (E i : crelation.keySet()) &#123;</span><br><span class="line"><span class="keyword">assert</span> nodelist.contains(i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (E i : belong.keySet()) &#123;</span><br><span class="line"><span class="keyword">assert</span> nodelist.contains(i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (E i : nodelist) &#123;</span><br><span class="line"><span class="keyword">assert</span> belong.containsKey(i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (E i : nodelist) &#123;</span><br><span class="line">List&lt;E&gt; relist = relation.get(i);</span><br><span class="line"><span class="keyword">for</span> (E j : relist) &#123;</span><br><span class="line"><span class="keyword">assert</span> relation.get(j).contains(i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (E i : belong.keySet()) &#123;</span><br><span class="line"><span class="keyword">int</span> trackid = belong.get(i);</span><br><span class="line"><span class="keyword">boolean</span> have = <span class="keyword">false</span>;</span><br><span class="line"><span class="keyword">for</span> (Track j : orbitlist) &#123;</span><br><span class="line"><span class="keyword">if</span> (j.id() == trackid) &#123;</span><br><span class="line">have = <span class="keyword">true</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">assert</span> trackid == -<span class="number">1</span> || have;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="pre-post-condition"><a href="#pre-post-condition" class="headerlink" title="pre-/post-condition"></a>pre-/post-condition</h3><p>Pre-condition保障：<br>在从文件中读入信息以新建一个对象时，通过校验用户信息的合法性来保障新建对象符合Rep，同时在构造方法中，保证采用符合对象Rep的方式来构建对象。如何校验用户信息合法性在上一节已经有详细描述。</p>
<p>Post-condition保障：<br>进行每个操作时，都考虑如何不违背Rep之规定，每次操作完毕之后，都checkRep来检查自身是否符合Rep规定<br>例如，在addnode时，如果用户未规定具体轨道，则将轨道设置为-1，并且像belong, relation和crelation增加初始状态，以满足Rep要求</p>
<h2 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h2><p>使用Java标准日志java logging，首先新建一个Logger对象，设置其名称为ClientLog<br>之后，设置其Level为Info<br>之后，为其添加fileHandler，如果未找到日志文件，输出错误信息并要求用户建立文件<br>之后，在所有命令执行成功之后进行log写入，在所有捕获到异常之处也进行log写入</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/23/Lab3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zeromaker">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/author5.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zeromaker's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/23/Lab3/" itemprop="url">Lab3</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-06-23T22:40:42+08:00">
                2019-06-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="软件构造Lab3总结"><a href="#软件构造Lab3总结" class="headerlink" title="软件构造Lab3总结"></a>软件构造Lab3总结</h1><hr>
<h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>Lab3是所有实验当中最繁琐复杂的一个，设计难度和实现难度比起之前的实验均有极大的提升，又由于没能充分利用好五一假期都时间，导致五一假期回来之后的两个late days超负荷工作，望引以为戒</p>
<hr>
<p>软件构造lab3主要需要完成如下任务</p>
<blockquote>
<ul>
<li>三个具体应用场景的开发，共同特征为多轨道系统<br>我选择的三个场景为<ul>
<li>StellarSystem</li>
<li>AtomStructure</li>
<li>SocialNetworkCircle</li>
</ul>
</li>
</ul>
</blockquote>
<p>每个场景需要实现以下共同功能</p>
<blockquote>
<ul>
<li>基于语法的图数据输入</li>
<li>面向复用设计的各种ADT</li>
<li>GUI</li>
<li>可复用的第三方API</li>
</ul>
</blockquote>
<p>每个具体应用还需要实现一些特殊功能</p>
<h3 id="StellarSystem"><a href="#StellarSystem" class="headerlink" title="StellarSystem"></a>StellarSystem</h3><blockquote>
<ul>
<li>查询行星位置</li>
<li>卫星功能</li>
</ul>
</blockquote>
<h3 id="AtomStructure"><a href="#AtomStructure" class="headerlink" title="AtomStructure"></a>AtomStructure</h3><blockquote>
<ul>
<li>电子跃迁</li>
</ul>
</blockquote>
<h3 id="SocialNetworkCircle"><a href="#SocialNetworkCircle" class="headerlink" title="SocialNetworkCircle"></a>SocialNetworkCircle</h3><blockquote>
<ul>
<li>计算轨道</li>
<li>计算任意两个人的逻辑距离</li>
</ul>
</blockquote>
<hr>
<h2 id="可复用ADT设计"><a href="#可复用ADT设计" class="headerlink" title="可复用ADT设计"></a>可复用ADT设计</h2><h3 id="CircularOrbit-lt-L-E-gt"><a href="#CircularOrbit-lt-L-E-gt" class="headerlink" title="CircularOrbit&lt;L,E&gt;"></a>CircularOrbit&lt;L,E&gt;</h3><p>为了通用性，将该类设计为一个接口，通过总结，需要设计在接口中的共性属性如下</p>
<ol>
<li>中心物体</li>
<li>轨道上所有物体的list</li>
<li>所有轨道的list</li>
<li>表示所有关系的Map relation</li>
<li>表示物体与中心体之间关系的Map crelation</li>
<li>表示物体属于某个轨道的Mao belong<br>具体AF如下<br>AF(CircularOrbit) = {<br>center = The center object<br>nodelist = The list that contains all the node<br>orbitlist = The list that contains all the tracks<br>relation = A Map, each key is a node in nodelist, the value is the list that related with key.<br>crealation = A Map, each key is a node in nodelist, the value represents the relation between center object and key<br>belong = A Map, each key is a node in nodelist, the value represents the track key belongs to.<br>}</li>
</ol>
<h3 id="Track"><a href="#Track" class="headerlink" title="Track"></a>Track</h3><p>共性属性总结如下：</p>
<ol>
<li>轨道半径，高精度浮点数类</li>
<li>轨道id，轨道的唯一标识符</li>
</ol>
<h3 id="PhysicalObject"><a href="#PhysicalObject" class="headerlink" title="PhysicalObject"></a>PhysicalObject</h3><p>为了复用考虑，首先建立一个借口，其中含有共性属性如下</p>
<ol start="2">
<li>物体名称，String类<br>共性方法即为get上述属性的方法<br>之后使用PhysicalObject类实现该结构，之后所有类都继承自该类</li>
<li>Stellar<br>StellarSystem的中心物体，拥有特性属性如下</li>
<li>恒星半径，浮点类</li>
<li>恒星质量，浮点类<br>特性方法为get上述属性的方法。</li>
<li>Planet<br>StellarSystem的轨道物体，拥有特性属性如下</li>
<li>行星状态，String类</li>
<li>行星颜色，String类</li>
<li>行星轨道半径，高精度浮点类</li>
<li>行星半径，高精度浮点类</li>
<li>行星速度，高精度浮点类</li>
<li>行星公转方向，String类</li>
<li>行星初始角度，高精度浮点类<br>特性方法为get上述属性的方法。</li>
<li>Person<br>SocialNetwork的中心物体和轨道物体，拥有特性属性如下</li>
<li>年龄， 整数类</li>
<li>性别， String类<br>特性方法为get上述属性的方法。</li>
<li>Electron<br>AtomStructure的轨道物体，拥有特性属性如下</li>
<li>Id，电子加入的顺序<br>特性方法为get上述属性的方法。</li>
</ol>
<h2 id="可复用API设计"><a href="#可复用API设计" class="headerlink" title="可复用API设计"></a>可复用API设计</h2><h3 id="getObjectDistributionEntropy方法设计"><a href="#getObjectDistributionEntropy方法设计" class="headerlink" title="getObjectDistributionEntropy方法设计"></a>getObjectDistributionEntropy方法设计</h3><p>Entropy = Sigma (Si*log(Si/N))<br>实现如下<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;L, E&gt; <span class="function"><span class="keyword">double</span> <span class="title">getObjectDistributionEntropy</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="keyword">final</span> AbstractCircularOrbit&lt;L, E&gt; c)</span> </span>&#123;</span><br><span class="line"><span class="keyword">double</span> ans = <span class="number">0.0</span>;</span><br><span class="line"><span class="keyword">for</span> (Track i : c.orbitlist()) &#123;</span><br><span class="line"><span class="keyword">double</span> size = c.objectonorbit(i.id()).size();</span><br><span class="line">ans += size * (Math.log(size / c.nodelist().size()));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="getLogicalDistance"><a href="#getLogicalDistance" class="headerlink" title="getLogicalDistance"></a>getLogicalDistance</h3><p>通过bfs方法获取两个节点之间的距离<br>具体实现如下<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;L, E&gt; <span class="function"><span class="keyword">int</span> <span class="title">getLogicalDistance</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="keyword">final</span> AbstractCircularOrbit&lt;L, E&gt; c,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="keyword">final</span> E start, <span class="keyword">final</span> E end)</span> </span>&#123;</span><br><span class="line">Map&lt;E, Integer&gt; dis = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"><span class="keyword">for</span> (E i : c.nodelist()) &#123;</span><br><span class="line">dis.put(i, -<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">dis.put(start, <span class="number">0</span>);</span><br><span class="line">Queue&lt;E&gt; queue = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">queue.add(start);</span><br><span class="line"><span class="keyword">while</span> (!queue.isEmpty()) &#123;</span><br><span class="line">E nowx = queue.element();</span><br><span class="line">queue.remove();</span><br><span class="line"><span class="keyword">if</span> (nowx.equals(c.center())) &#123;</span><br><span class="line"><span class="keyword">for</span> (E i : c.nodelist()) &#123;</span><br><span class="line"><span class="keyword">if</span> (c.crelation().get(i)!=-<span class="number">1</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (c.crelation().get(i) != -<span class="number">1</span> &amp;&amp; dis.get(i) == -<span class="number">1</span>) &#123;</span><br><span class="line">dis.put(i, dis.get(nowx) + <span class="number">1</span>);</span><br><span class="line">queue.add(i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">for</span> (E i : c.relation().get(nowx)) &#123;</span><br><span class="line"><span class="keyword">if</span> (dis.get(i) == -<span class="number">1</span>) &#123;</span><br><span class="line">dis.put(i, dis.get(nowx) + <span class="number">1</span>);</span><br><span class="line">queue.add(i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> dis.get(end);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="应用设计与开发"><a href="#应用设计与开发" class="headerlink" title="应用设计与开发"></a>应用设计与开发</h2><h3 id="StellarSystem-1"><a href="#StellarSystem-1" class="headerlink" title="StellarSystem"></a>StellarSystem</h3><p>特性功能实现如下：</p>
<ol>
<li>输出t时刻行星的位置：通过传入高精度浮点型参数time，调用在StellarSystem类中实现的方法，计算得到行星的位置</li>
<li>输出行星之间的物理距离：通过传入高精度浮点型参数time，调用在StellarSystem类中实现的方法，计算得到行星之间的物理距离<br>设计了一套交互系统和命令解析系统，能够解析用户的输入，进行各种操作</li>
</ol>
<h3 id="AtomStructure-1"><a href="#AtomStructure-1" class="headerlink" title="AtomStructure"></a>AtomStructure</h3><p>特性功能实现如下：</p>
<ol>
<li>跃迁方法：通过传入跃迁前的轨道和跃迁后的轨道，通过调用在AtomStructure中实现的方法，模拟电子的跃迁行为</li>
</ol>
<h3 id="SocialNetworkCircle-1"><a href="#SocialNetworkCircle-1" class="headerlink" title="SocialNetworkCircle"></a>SocialNetworkCircle</h3><p>特性方法实现如下：</p>
<ol>
<li>判定用户处于哪个轨道：通过调用SocialNetworkCircle中实现的方法，计算得到结果</li>
<li>计算信息扩散度：通过调用SocialNetworkCircle中实现的方法，计算得到结果</li>
<li>计算逻辑距离：通过调用SocialNetworkCircle中实现的方法，计算得到结果</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/23/Lab2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zeromaker">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/author5.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zeromaker's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/23/Lab2/" itemprop="url">Lab2</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-06-23T21:58:57+08:00">
                2019-06-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="软件构造Lab2总结"><a href="#软件构造Lab2总结" class="headerlink" title="软件构造Lab2总结"></a>软件构造Lab2总结</h1><hr>
<p>软件构造lab2主要有以下几个任务需要完成</p>
<blockquote>
<ul>
<li>Poetic Walks</li>
<li>Re-implement the Social Network in Lab1</li>
</ul>
</blockquote>
<p>每个任务还分别有一些子任务需要实现：</p>
<h3 id="Poetic-Walks"><a href="#Poetic-Walks" class="headerlink" title="Poetic Walks"></a>Poetic Walks</h3><blockquote>
<ul>
<li>Test Graph​<string></string></li>
<li>Implement Graph​<string></string></li>
<li>Implement generic Graph<l></l></li>
<li>Poetic walks</li>
</ul>
</blockquote>
<h3 id="Re-implement-the-Social-Network-in-Lab1"><a href="#Re-implement-the-Social-Network-in-Lab1" class="headerlink" title="Re-implement the Social Network in Lab1"></a>Re-implement the Social Network in Lab1</h3><blockquote>
<ul>
<li>两种方式重新实现</li>
<li>通过原先的测试用例</li>
</ul>
</blockquote>
<h3 id="Playing-Chess"><a href="#Playing-Chess" class="headerlink" title="Playing Chess"></a>Playing Chess</h3><blockquote>
<ul>
<li>从头开始实现一个Chess程序</li>
</ul>
</blockquote>
<hr>
<h2 id="Poetic-Walks-1"><a href="#Poetic-Walks-1" class="headerlink" title="Poetic Walks"></a>Poetic Walks</h2><h3 id="Problem-1-Test-Graph"><a href="#Problem-1-Test-Graph" class="headerlink" title="Problem 1: Test Graph "></a>Problem 1: Test Graph <string></string></h3><p>设计思路：为了测试图接口的实现是否正确，功能是否完整，可以通过生成一个足够复杂的模拟图，并在对其中的每一个节点使用source和target方法，查询返回的结果是否符合预期，即可达到检验实现是否正确的目的<br>设计过程：我们设计了一个拥有五个节点的模拟图，之后，我们查询每一个节点是否存在于节点列表中，我们对每一个节点调用source和target方法，并检验返回的集合中是否存在我们所期望的所有元素，集合中元素的个数是否符合我们的预期<br>代码实现：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GraphTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Graph&lt;String&gt; graph=emptyInstance();</span><br><span class="line">graph.set(<span class="string">"1"</span>, <span class="string">"2"</span>, <span class="number">1</span>);</span><br><span class="line">graph.set(<span class="string">"1"</span>, <span class="string">"3"</span>, <span class="number">2</span>);</span><br><span class="line">graph.set(<span class="string">"1"</span>, <span class="string">"4"</span>, <span class="number">3</span>);</span><br><span class="line">graph.set(<span class="string">"2"</span>, <span class="string">"3"</span>, <span class="number">4</span>);</span><br><span class="line">graph.set(<span class="string">"2"</span>, <span class="string">"4"</span>, <span class="number">5</span>);</span><br><span class="line">graph.set(<span class="string">"4"</span>, <span class="string">"5"</span>, <span class="number">6</span>);</span><br><span class="line">graph.set(<span class="string">"5"</span>, <span class="string">"2"</span>, <span class="number">7</span>);</span><br><span class="line">graph.set(<span class="string">"3"</span>, <span class="string">"5"</span>, <span class="number">8</span>);</span><br><span class="line">Set&lt;String&gt; nowvertices=graph.vertices();</span><br><span class="line">assertTrue(nowvertices.contains(<span class="string">"1"</span>));</span><br><span class="line">assertTrue(nowvertices.contains(<span class="string">"2"</span>));</span><br><span class="line">assertTrue(nowvertices.contains(<span class="string">"3"</span>));</span><br><span class="line">assertTrue(nowvertices.contains(<span class="string">"4"</span>));</span><br><span class="line">assertTrue(nowvertices.contains(<span class="string">"5"</span>));</span><br><span class="line"></span><br><span class="line">Map&lt;String,Integer&gt; targetMap = graph.targets(<span class="string">"1"</span>);</span><br><span class="line">assertTrue(targetMap.containsKey(<span class="string">"2"</span>));</span><br><span class="line">assertTrue(targetMap.get(<span class="string">"2"</span>)==<span class="number">1</span>);</span><br><span class="line">assertTrue(targetMap.containsKey(<span class="string">"3"</span>));</span><br><span class="line">assertTrue(targetMap.get(<span class="string">"3"</span>)==<span class="number">2</span>);</span><br><span class="line">assertTrue(targetMap.containsKey(<span class="string">"4"</span>));</span><br><span class="line">assertTrue(targetMap.get(<span class="string">"4"</span>)==<span class="number">3</span>);</span><br><span class="line">targetMap = graph.targets(<span class="string">"2"</span>);</span><br><span class="line">assertTrue(targetMap.containsKey(<span class="string">"3"</span>));</span><br><span class="line">assertTrue(targetMap.get(<span class="string">"3"</span>)==<span class="number">4</span>);</span><br><span class="line">assertTrue(targetMap.containsKey(<span class="string">"4"</span>));</span><br><span class="line">assertTrue(targetMap.get(<span class="string">"4"</span>)==<span class="number">5</span>);</span><br><span class="line">targetMap = graph.targets(<span class="string">"3"</span>);</span><br><span class="line">assertTrue(targetMap.containsKey(<span class="string">"5"</span>));</span><br><span class="line">assertTrue(targetMap.get(<span class="string">"5"</span>)==<span class="number">8</span>);</span><br><span class="line">targetMap = graph.targets(<span class="string">"4"</span>);</span><br><span class="line">assertTrue(targetMap.containsKey(<span class="string">"5"</span>));</span><br><span class="line">assertTrue(targetMap.get(<span class="string">"5"</span>)==<span class="number">6</span>);</span><br><span class="line">targetMap = graph.targets(<span class="string">"5"</span>);</span><br><span class="line">assertTrue(targetMap.containsKey(<span class="string">"2"</span>));</span><br><span class="line">assertTrue(targetMap.get(<span class="string">"2"</span>)==<span class="number">7</span>);</span><br><span class="line"></span><br><span class="line">Map&lt;String,Integer&gt; sourceMap=graph.sources(<span class="string">"1"</span>);</span><br><span class="line">assertTrue(sourceMap.isEmpty());</span><br><span class="line">sourceMap=graph.sources(<span class="string">"2"</span>);</span><br><span class="line">assertTrue(sourceMap.containsKey(<span class="string">"1"</span>));</span><br><span class="line">assertTrue(sourceMap.get(<span class="string">"1"</span>)==<span class="number">1</span>);</span><br><span class="line">assertTrue(sourceMap.containsKey(<span class="string">"5"</span>));</span><br><span class="line">assertTrue(sourceMap.get(<span class="string">"5"</span>)==<span class="number">7</span>);</span><br><span class="line">sourceMap=graph.sources(<span class="string">"3"</span>);</span><br><span class="line">assertTrue(sourceMap.containsKey(<span class="string">"1"</span>));</span><br><span class="line">assertTrue(sourceMap.get(<span class="string">"1"</span>)==<span class="number">2</span>);</span><br><span class="line">sourceMap=graph.sources(<span class="string">"4"</span>);</span><br><span class="line">assertTrue(sourceMap.containsKey(<span class="string">"1"</span>));</span><br><span class="line">assertTrue(sourceMap.get(<span class="string">"1"</span>)==<span class="number">3</span>);</span><br><span class="line">assertTrue(sourceMap.containsKey(<span class="string">"2"</span>));</span><br><span class="line">assertTrue(sourceMap.get(<span class="string">"2"</span>)==<span class="number">5</span>);</span><br><span class="line">sourceMap=graph.sources(<span class="string">"5"</span>);</span><br><span class="line">assertTrue(sourceMap.containsKey(<span class="string">"3"</span>));</span><br><span class="line">assertTrue(sourceMap.get(<span class="string">"3"</span>)==<span class="number">8</span>);</span><br><span class="line">assertTrue(sourceMap.containsKey(<span class="string">"4"</span>));</span><br><span class="line">assertTrue(sourceMap.get(<span class="string">"4"</span>)==<span class="number">6</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="Implement-Graph"><a href="#Implement-Graph" class="headerlink" title="Implement Graph "></a>Implement Graph <string></string></h3><ol>
<li>边类（Edges类）的设计<br>a)    Filed设计<br>i.    from：一个String类型变量，表示这条边的起始节点<br>ii.    to：一个String类型变量，表示这条边指向的节点<br>iii.    wright：一个int类型变量，表示这条边的权值<br>b)    抽象函数<br>i.    AF(Graph)={vertices, edges | where vertices is a String Set and edges is an Edge List}<br>c)    表示保护<br>i.    from and to are Strings, so are guaranteed immutable avoid sharing the rep’s vertices and edges object with clients.<br>ii.    All fields are private final<br>d)    方法设计<br>i.    getFrom方法：返回from的值<br>ii.    getTo方法：返回to的值<br>iii.    getWeight方法：返回weight的值<br>iv.    toString方法：将edges类转换成人类可理解的字符串，具体格式为from —&gt; to</li>
<li>图类（ConcreteEdgesGraph类）的设计<br>a)    Filed设计<br>i.    Edges：一个list类型变量，list中每一个元素是一个Edges类型，代表图中的一条边<br>ii.    Vertices：一个list类型变量，list中每一个元素是一个String类型，代表图中的一个节点<br>b)    抽象函数<br>i.    AF(Graph)={vertices, edges | where vertices is a String Set and edges is an Edge List}<br>c)    表示保护<br>i.    All fields are private<br>ii.    vertices and edges are mutable, so all methods make defensive copies to avoid sharing the rep’s vertices and edges object with clients.<br>d)    方法设计<br>i.    Add方法：添加一个节点，如果节点已经存在返回true，否则返回false<br>ii.    Set 方法：添加一条边，如果这条边已经存在返回这条边被修改前的权值，如果这条边不存在返回0<br>iii.    Remove方法：删除一个节点，如果节点不存在返回false，否则返回true<br>iv.    Vertices方法：返回图的节点集合<br>v.    Source方法：返回含有指向某个节点的边的节点集合<br>vi.    Targets方法：返回某个节点指向的所有节点的集合<br>vii.    ToString方法：将图转化为人类友好的字符串</li>
</ol>
<h2 id="Implement-ConcreteVerticesGraph"><a href="#Implement-ConcreteVerticesGraph" class="headerlink" title="Implement ConcreteVerticesGraph"></a>Implement ConcreteVerticesGraph</h2><p>点类（Vertex类）的设计<br>a) Filed设计<br>name：一个String类型变量，表示这个节点的名称<br>link：一个Map类型的变量，每个元素是一个&lt;String, Integer&gt;键值对，代表从该节点String出发含有连向某一个节点的一条权值为Integer的边<br>b) 抽象函数<br>AF(Vertex) = {name, link | link contains the vertex that this vertex connect with}<br>c) 表示保护<br>This class is mutable<br>d)    方法设计<br>name方法：返回name的值<br>link方法：返回link的值<br>toString方法：将vertex类转换成人类可理解的字符串<br>2.图类（ConcreteVerticesGraph类）的设计<br>a)    Filed设计<br>i.    Vertices：一个List类型，每个元素是一个Vertex，表示图中的某一个节点<br>b)    抽象函数<br>i.    AF(graph) = {vertices | vertices is a list of vertex}<br>c)    表示保护<br>i.    All fields are private final<br>ii.    vertices is mutable, so all methods make defensive copies to avoid sharing the rep’s vertices and edges object with clients.<br>d)    方法设计<br>i.    Add方法：添加一个节点，如果节点已经存在返回true，否则返回false<br>ii.    Set 方法：添加一条边，如果这条边已经存在返回这条边被修改前的权值，如果这条边不存在返回0<br>iii.    Remove方法：删除一个节点，如果节点不存在返回false，否则返回true<br>iv.    Vertices方法：返回图的节点集合<br>v.    Source方法：返回含有指向某个节点的边的节点集合<br>vi.    Targets方法：返回某个节点指向的所有节点的集合<br>vii.    ToString方法：将图转化为人类友好的字符串</p>
<h3 id="Make-the-implementations-generic"><a href="#Make-the-implementations-generic" class="headerlink" title="Make the implementations generic"></a>Make the implementations generic</h3><ol>
<li>ConcreteEdgesGraph implement<br>a)    Add方法<br>i.    设计思路：首先判断待添加节点是否在vertices当中，之后向vertices中添加一个节点<br>b)    Set方法<br>i.    设计思路：首先查询待添加边的起点和终点是否在vertices当中，若不在，则进行添加，之后查找整个边集，若找到起始点相同的边，重设权值，若找不到，新建一条边并添加<br>c)    Remove方法<br>i.    设计思路：首先查询vertices中是否存在节点vertex，若不存在返回false,若存在则遍历边表，删除所有指向和从这个节点出发的边<br>d)    Vertices方法<br>i.    设计思路：返回vertices<br>e)    Source方法<br>i.    设计思路：搜索整个边表，返回所有指向该节点的边<br>f)    Targets方法<br>i.    设计思路：搜索整个边表，返回所有从该节点出发的边<br>g)    toString方法<br>i.    设计思路：将所有edge的toString结果进行拼接<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GraphtoStringTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Graph&lt;String&gt; graph=emptyInstance();</span><br><span class="line">graph.set(<span class="string">"1"</span>, <span class="string">"2"</span>, <span class="number">1</span>);</span><br><span class="line">graph.set(<span class="string">"1"</span>, <span class="string">"3"</span>, <span class="number">2</span>);</span><br><span class="line">graph.set(<span class="string">"1"</span>, <span class="string">"4"</span>, <span class="number">3</span>);</span><br><span class="line">graph.set(<span class="string">"2"</span>, <span class="string">"3"</span>, <span class="number">4</span>);</span><br><span class="line">graph.set(<span class="string">"2"</span>, <span class="string">"4"</span>, <span class="number">5</span>);</span><br><span class="line">graph.set(<span class="string">"4"</span>, <span class="string">"5"</span>, <span class="number">6</span>);</span><br><span class="line">graph.set(<span class="string">"5"</span>, <span class="string">"2"</span>, <span class="number">7</span>);</span><br><span class="line">graph.set(<span class="string">"3"</span>, <span class="string">"5"</span>, <span class="number">8</span>);</span><br><span class="line">assertEquals(graph.toString(),<span class="string">"1 ----&gt; 2\n"</span> + </span><br><span class="line"><span class="string">"1 ----&gt; 3\n"</span> + </span><br><span class="line"><span class="string">"1 ----&gt; 4\n"</span> + </span><br><span class="line"><span class="string">"2 ----&gt; 3\n"</span> + </span><br><span class="line"><span class="string">"2 ----&gt; 4\n"</span> + </span><br><span class="line"><span class="string">"4 ----&gt; 5\n"</span> + </span><br><span class="line"><span class="string">"5 ----&gt; 2\n"</span> + </span><br><span class="line"><span class="string">"3 ----&gt; 5"</span> );</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* Testing Edge...</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Testing strategy for Edge</span></span><br><span class="line"><span class="comment">//   Test getFrom(), getTo(), getWeight() and toString()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// tests for operations of Edge</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">EdgeTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Edge&lt;String&gt; edge=<span class="keyword">new</span> Edge&lt;String&gt;(<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="number">1</span>);</span><br><span class="line">assertEquals(edge.getFrom(),<span class="string">"A"</span>);</span><br><span class="line">assertEquals(edge.getTo(),<span class="string">"B"</span>);</span><br><span class="line">assertEquals(edge.getWeight(),<span class="number">1</span>);</span><br><span class="line">assertEquals(edge.toString(),<span class="string">"A ----&gt; B"</span>);</span><br><span class="line">edge=<span class="keyword">new</span> Edge&lt;String&gt;(<span class="string">"FJASKLDFU"</span>,<span class="string">"QWOIRP"</span>,<span class="number">123</span>);</span><br><span class="line">assertEquals(edge.getFrom(),<span class="string">"FJASKLDFU"</span>);</span><br><span class="line">assertEquals(edge.getTo(),<span class="string">"QWOIRP"</span>);</span><br><span class="line">assertEquals(edge.getWeight(),<span class="number">123</span>);</span><br><span class="line">assertEquals(edge.toString(),<span class="string">"FJASKLDFU ----&gt; QWOIRP"</span>);</span><br><span class="line">edge=<span class="keyword">new</span> Edge&lt;String&gt;(<span class="string">"@#$%"</span>,<span class="string">"654"</span>,<span class="number">56</span>);</span><br><span class="line">assertEquals(edge.getFrom(),<span class="string">"@#$%"</span>);</span><br><span class="line">assertEquals(edge.getTo(),<span class="string">"654"</span>);</span><br><span class="line">assertEquals(edge.getWeight(),<span class="number">56</span>);</span><br><span class="line">assertEquals(edge.toString(),<span class="string">"@#$% ----&gt; 654"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>2.ConcreteVerticesGraph implement<br>a)    Add方法<br>i.    设计思路：首先判断待添加节点是否在vertices当中，之后向vertices中添加一个节点<br>b)    Set方法<br>i.    设计思路：首先查询待添加边的起点和终点是否在vertices当中，若不在，则进行添加，之后查找起点的link中是否含有终点，若含有，则重置权值，若不含，则新建一个键值对并插入<br>c)    Remove方法<br>i.    设计思路：首先查询vertices中是否存在节点vertex，若不存在返回false,若存在则遍历节点列表，删除这个节点的整个link和其他节点link中的该节点<br>d)    Vertices方法<br>i.    设计思路：返回vertices<br>e)    Source方法<br>i.    设计思路：搜索所有节点，若某个节点的link中含有该节点，则添加到答案Map中<br>f)    Targets方法<br>i.    设计思路：搜索该节点的link，返回在其中的所有节点<br>g)    toString方法<br>i.    设计思路：将所有vertex的toString结果进行拼接</p>
<h3 id="Implement-Graph-empty"><a href="#Implement-Graph-empty" class="headerlink" title="Implement Graph.empty()"></a>Implement Graph.empty()</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;L&gt; <span class="function">Graph&lt;L&gt; <span class="title">empty</span><span class="params">()</span> </span>&#123;</span><br><span class="line">List&lt;Vertex&lt;L&gt;&gt; vertices = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> ConcreteVerticesGraph&lt;L&gt;(vertices);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Problem-4-Poetic-walks"><a href="#Problem-4-Poetic-walks" class="headerlink" title="Problem 4: Poetic walks"></a>Problem 4: Poetic walks</h3><p>###Test GraphPoet<br>为了测试GraphPoet的正确性，使用一首莎士比亚的十四行诗作为训练语料，之后使用原句中去掉一个或者两个词的输入作为测试样例，测试输出是否符合预期</p>
<h3 id="Implement-GraphPoet"><a href="#Implement-GraphPoet" class="headerlink" title="Implement GraphPoet"></a>Implement GraphPoet</h3><p>a)    Filed设计<br>graph：一个Graph<string>类型<br>b)    抽象函数<br>AF(GraphPoet) = {Graph | a String graph}<br>c)    表示保护<br>All fields are private final<br>Graph is immutable<br>d)    方法设计</string></p>
<ol>
<li>构造方法<br>i.    设计思路：初始化一个Graph类，之后根据实验手册说明，根据语料库建立符合规则的图</li>
<li>Poem方法<br>i.    设计思路：根据输入语句，在初始化完成的Graph上寻找实验手册中定义的brige word，若找到则插入到两个词之间<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> Graph&lt;String&gt; graph = Graph.empty();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Abstraction function:</span></span><br><span class="line"><span class="comment">//   AF(GraphPoet) = &#123;Graph | a String graph&#125;</span></span><br><span class="line"><span class="comment">// Representation invariant:</span></span><br><span class="line"><span class="comment">//   graph is a graph of String</span></span><br><span class="line"><span class="comment">// Safety from rep exposure:</span></span><br><span class="line"><span class="comment">//   All fields are private final</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Create a new poet with the graph from corpus (as described above).</span></span><br><span class="line"><span class="comment">* </span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> corpus text file from which to derive the poet's affinity graph</span></span><br><span class="line"><span class="comment">* <span class="doctag">@throws</span> IOException if the corpus file cannot be found or read</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">GraphPoet</span><span class="params">(File corpus)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">Reader reader = <span class="keyword">new</span> InputStreamReader(<span class="keyword">new</span> FileInputStream(corpus));</span><br><span class="line">String input=<span class="string">""</span>;</span><br><span class="line"><span class="keyword">int</span> nowchar;</span><br><span class="line"><span class="keyword">while</span> ((nowchar=reader.read())!=-<span class="number">1</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (Character.isSpaceChar((<span class="keyword">char</span>) nowchar)) &#123;</span><br><span class="line">nowchar=<span class="string">' '</span>;</span><br><span class="line">&#125;</span><br><span class="line">input=input+(<span class="keyword">char</span>)nowchar;</span><br><span class="line">&#125;</span><br><span class="line">String[] words=input.split(<span class="string">" "</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;words.length;i++) &#123;</span><br><span class="line">words[i]=words[i].toLowerCase();</span><br><span class="line"><span class="keyword">this</span>.graph.add(words[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;words.length;i++) &#123;</span><br><span class="line">Map&lt;String, Integer&gt; targetMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;words.length;j++) &#123;</span><br><span class="line"><span class="keyword">if</span> (targetMap.containsKey(words[j])) &#123;</span><br><span class="line"><span class="keyword">int</span> preweight=targetMap.get(words[j]);</span><br><span class="line">targetMap.put(words[j], preweight+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">targetMap.put(words[j],<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (Map.Entry&lt;String, Integer&gt; j : targetMap.entrySet()) &#123;</span><br><span class="line">graph.set(words[i], j.getKey(), j.getValue());</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">reader.close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// checkRep</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">checkRep</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Generate a poem.</span></span><br><span class="line"><span class="comment">* </span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> input string from which to create the poem</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span> poem (as described above)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">poem</span><span class="params">(String input)</span> </span>&#123;</span><br><span class="line">String[] words=input.split(<span class="string">" "</span>);</span><br><span class="line">String ans=<span class="string">""</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;words.length-<span class="number">1</span>;i++) &#123;</span><br><span class="line">String source=words[i].toLowerCase();</span><br><span class="line">String target=words[i+<span class="number">1</span>].toLowerCase();</span><br><span class="line">String bridge=<span class="string">""</span>;</span><br><span class="line"><span class="keyword">if</span> (graph.vertices().contains(source) &amp;&amp; graph.vertices().contains(target)) &#123;</span><br><span class="line">Map&lt;String,Integer&gt; targetMap = graph.targets(source);</span><br><span class="line"><span class="keyword">int</span> nowmax=-<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (Map.Entry&lt;String, Integer&gt; j : targetMap.entrySet()) &#123;</span><br><span class="line">Map&lt;String,Integer&gt; secondTargetMap=graph.targets(j.getKey());</span><br><span class="line"><span class="keyword">if</span> (secondTargetMap.containsKey(target)) &#123;</span><br><span class="line"><span class="keyword">if</span> (nowmax==-<span class="number">1</span>) &#123;</span><br><span class="line">nowmax=j.getValue()+secondTargetMap.get(target);</span><br><span class="line">bridge=j.getKey();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (j.getValue()+secondTargetMap.get(target)&gt;nowmax) &#123;</span><br><span class="line">nowmax=j.getValue()+secondTargetMap.get(target);</span><br><span class="line">bridge=j.getKey();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (i==<span class="number">0</span>) &#123;</span><br><span class="line">ans=ans+words[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">ans=ans+<span class="string">" "</span>+words[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!bridge.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">ans=ans+<span class="string">" "</span>+bridge;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (i==words.length-<span class="number">2</span>) &#123;</span><br><span class="line">ans=ans+<span class="string">" "</span>+words[i+<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="Re-implement-the-Social-Network-in-Lab1-1"><a href="#Re-implement-the-Social-Network-in-Lab1-1" class="headerlink" title="Re-implement the Social Network in Lab1"></a>Re-implement the Social Network in Lab1</h2><ol>
<li>Field设计<br>a)    Igraph：一个Graph<string>类型的实例</string></li>
<li>方法设计<br>a)    AddVertex<br>i.    设计思路：调用Graph类的add方法<br>b)    addEdge<br>i.    设计思路：调用Graph类的set方法<br>c)    getDistance<br>i.    设计思路：使用广度优先搜索的方式，将原本<br>代码如下<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FriendshipGraph</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> ConcreteEdgesGraph&lt;Person&gt; igraph=<span class="keyword">new</span> ConcreteEdgesGraph&lt;Person&gt;(<span class="keyword">new</span> HashSet&lt;Person&gt;(), <span class="keyword">new</span> ArrayList&lt;&gt;());</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addVertex</span><span class="params">(Person node)</span> </span>&#123;</span><br><span class="line">igraph.add(node);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(Person a, Person b)</span> </span>&#123;</span><br><span class="line">igraph.set(a, b, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getDistance</span><span class="params">(Person s, Person e)</span> </span>&#123;</span><br><span class="line"><span class="comment">//distance array</span></span><br><span class="line">Map&lt;Person,Integer&gt; dis = <span class="keyword">new</span> HashMap&lt;Person,Integer&gt;();</span><br><span class="line"><span class="comment">//Initialize distance array, -1 represents infinity</span></span><br><span class="line"><span class="keyword">for</span> (Person i : igraph.vertices()) &#123;</span><br><span class="line">dis.put(i, -<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (s==e) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Initialize distance array, distance between s and s is 0</span></span><br><span class="line">dis.put(s,<span class="number">0</span>);</span><br><span class="line"><span class="comment">//bfs queue</span></span><br><span class="line">Queue&lt;Person&gt; queue = <span class="keyword">new</span> LinkedList&lt;Person&gt;();</span><br><span class="line"><span class="comment">//add s to queue</span></span><br><span class="line">queue.offer(s);</span><br><span class="line"><span class="keyword">while</span> (!queue.isEmpty()) &#123;</span><br><span class="line">Person x=queue.element();</span><br><span class="line">Map&lt;Person,Integer&gt; linklist=igraph.targets(x);</span><br><span class="line"><span class="keyword">for</span> (Person i : linklist.keySet()) &#123;</span><br><span class="line"><span class="comment">// if find e</span></span><br><span class="line"><span class="keyword">if</span> (i==e) &#123;</span><br><span class="line"><span class="keyword">return</span> dis.get(x)+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// if current point does not be visted</span></span><br><span class="line"><span class="keyword">if</span> (dis.get(i)==-<span class="number">1</span>) &#123;</span><br><span class="line"><span class="comment">// calculate distance</span></span><br><span class="line">dis.put(i, dis.get(x)+<span class="number">1</span>);</span><br><span class="line"><span class="comment">// add to queue</span></span><br><span class="line">queue.add(i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//remove the front of queue</span></span><br><span class="line">queue.remove(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> dis.get(e);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">FriendshipGraph graph = <span class="keyword">new</span> FriendshipGraph();</span><br><span class="line">Person rachel = <span class="keyword">new</span> Person(<span class="string">"Rachel"</span>);</span><br><span class="line">Person ross = <span class="keyword">new</span> Person(<span class="string">"Ross"</span>);</span><br><span class="line">Person ben = <span class="keyword">new</span> Person(<span class="string">"Ben"</span>);</span><br><span class="line">Person kramer = <span class="keyword">new</span> Person(<span class="string">"Kramer"</span>);</span><br><span class="line">graph.addVertex(rachel);</span><br><span class="line">graph.addVertex(ross);</span><br><span class="line">graph.addVertex(ben);</span><br><span class="line">graph.addVertex(kramer);</span><br><span class="line">graph.addEdge(rachel, ross);</span><br><span class="line">graph.addEdge(ross, rachel);</span><br><span class="line">graph.addEdge(ross, ben);</span><br><span class="line">graph.addEdge(ben, ross);</span><br><span class="line">System.out.println(graph.getDistance(rachel, ross));</span><br><span class="line"><span class="comment">//should print 1</span></span><br><span class="line">System.out.println(graph.getDistance(rachel, ben));</span><br><span class="line"><span class="comment">//should print 2</span></span><br><span class="line">System.out.println(graph.getDistance(rachel, rachel));</span><br><span class="line"><span class="comment">//should print 0</span></span><br><span class="line">System.out.println(graph.getDistance(rachel, kramer));</span><br><span class="line"><span class="comment">//should print -1</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>##Playing Chess</p>
<h3 id="ADT设计-实现方案"><a href="#ADT设计-实现方案" class="headerlink" title="ADT设计/实现方案"></a>ADT设计/实现方案</h3><ol>
<li>Player类<br>a)    Field设计<br>i.    Name:一个String类型，表示该玩家的名字<br>b)    抽象函数<br>i.    AF={name | name is a String}<br>c)    表示保护<br>i.    String为immutable,保证表示不会泄漏<br>d)    方法设计<br>i.    Name方法：返回name的值</li>
<li>Piece类<br>a)    Field设计<br>i.    Name：一个String类型，表示该棋子的名字<br>ii.    Belong：一个Player类型，表示该棋子属于哪个玩家<br>iii.    X：一个int类型，表示棋子所在的行<br>iv.    Y：一个int类型，表示棋子所在的列<br>b)    抽象函数<br>i.    AF={name,belong,x,y | name is a String, belong is a Player, x,y are two integer}<br>c)    表示保护<br>i.    This class is mutable<br>d)    方法设计<br>i.    Name方法：返回棋子名称<br>ii.    Belong方法：返回所属的玩家<br>iii.    Setname方法：修改棋子名称<br>iv.    SetPlayer方法：修改棋子所属玩家</li>
<li>Mychess类<br>a)    Field设计<br>i.    Type：一个String类型，表示游戏的种类<br>ii.    Board：一个List of List，每个元素是一个Piece类，表示棋盘<br>iii.    Chessboard：一个String类型，表示国际象棋初始时的棋子摆放<br>iv.    P1,P2：两个Player类型，表示游戏的两个玩家<br>b)    方法设计：<br>i.    Out方法：打印棋盘当前状态<br>ii.    Put方法：放置一个棋子<br>iii.    Move方法：移动棋子<br>iv.    Pick方法：提子<br>v.    Eat方法：吃子<br>vi.    Check方法：检查某个位置是否为空<br>vii.    Find方法：统计某个玩家当前拥有的棋子数量</li>
</ol>
<h3 id="ChessAndGoGame实现方案-以move为例"><a href="#ChessAndGoGame实现方案-以move为例" class="headerlink" title="ChessAndGoGame实现方案(以move为例)"></a>ChessAndGoGame实现方案(以move为例)</h3><p>实现时，需要尽可能考虑所有可能情况，处理所有的异常情况和可能解<br>代码如下<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">move</span><span class="params">(Player nowPlayer,Piece nowPiece, <span class="keyword">int</span> targetX,<span class="keyword">int</span> targetY)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (type.equals(<span class="string">"Go"</span>)) &#123;</span><br><span class="line">System.err.println(<span class="string">"You can't move piece while playing go"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ((type.equals(<span class="string">"Chess"</span>) &amp;&amp; (nowPiece.x()&gt;<span class="number">7</span> || nowPiece.y()&gt;<span class="number">7</span>)) || (type.equals(<span class="string">"Go"</span>) &amp;&amp; (nowPiece.x()&gt;<span class="number">19</span> || nowPiece.y()&gt;<span class="number">19</span>)))&#123;</span><br><span class="line">System.err.println(<span class="string">"The place you want to move is out of the board."</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">Piece choosePiece=board.get(nowPiece.x()).get(nowPiece.y());</span><br><span class="line"><span class="keyword">if</span> (choosePiece.name().equals(<span class="string">"0"</span>)) &#123;</span><br><span class="line">System.err.println(<span class="string">"The piece you choose doesn't exsit, please input another one."</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!(choosePiece.name().equals(nowPiece.name()))) &#123;</span><br><span class="line">System.err.println(<span class="string">"The name of the piece you input is wrong, please change it."</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!(choosePiece.belong().name().equals(nowPiece.belong().name()))) &#123;</span><br><span class="line">System.err.println(<span class="string">"You input wrong player name."</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!(nowPlayer.name().equals(P1.name())) &amp;&amp;</span><br><span class="line">!(nowPlayer.name().equals(P2.name()))) &#123;</span><br><span class="line">System.err.println(<span class="string">"You input wrong player name."</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!(nowPiece.belong().name()).equals(nowPlayer.name())) &#123;</span><br><span class="line">System.err.println(<span class="string">"The piece you choose doesn't belong with you, please choose another one."</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ((type.equals(<span class="string">"Chess"</span>) &amp;&amp; (targetX&gt;<span class="number">7</span> || targetY&gt;<span class="number">7</span>)) || (type.equals(<span class="string">"Go"</span>) &amp;&amp; (targetX&gt;<span class="number">19</span> || targetY&gt;<span class="number">19</span>)))&#123;</span><br><span class="line">System.err.println(<span class="string">"The place you want to move your piece to is out of the board."</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (nowPiece.x()==targetX &amp;&amp; nowPiece.y()==targetY) &#123;</span><br><span class="line">System.err.println(<span class="string">"Two place is same."</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">Piece targetPiece=board.get(targetX).get(targetY);</span><br><span class="line"><span class="keyword">if</span> (!targetPiece.name().equals(<span class="string">"0"</span>)) &#123;</span><br><span class="line">System.err.println(<span class="string">"The target palce already exsit a piece."</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">board.get(targetPiece.x()).get(targetPiece.y()).Setname(nowPiece.name());</span><br><span class="line">board.get(targetPiece.x()).get(targetPiece.y()).SetPlayer(nowPlayer);</span><br><span class="line">board.get(nowPiece.x()).get(nowPiece.y()).Setname(<span class="string">"0"</span>);</span><br><span class="line">board.get(nowPiece.x()).get(nowPiece.y()).SetPlayer(<span class="keyword">new</span> Player(<span class="string">"0"</span>));</span><br><span class="line">out();</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/23/Lab1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zeromaker">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/author5.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zeromaker's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/23/Lab1/" itemprop="url">Lab1</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-06-23T20:40:34+08:00">
                2019-06-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="软件构造Lab1总结"><a href="#软件构造Lab1总结" class="headerlink" title="软件构造Lab1总结"></a>软件构造Lab1总结</h1><hr>
<p>软件构造lab1主要有以下几个任务需要完成</p>
<blockquote>
<ul>
<li>Magic Squares</li>
<li>Turtle Graphics</li>
<li>Social Network</li>
<li>Tweet</li>
</ul>
</blockquote>
<p>每个任务还分别有一些子任务需要实现：</p>
<h3 id="Magic-Squares"><a href="#Magic-Squares" class="headerlink" title="Magic Squares"></a>Magic Squares</h3><blockquote>
<ul>
<li>实现幻方填写，并处理各种异常情况</li>
<li>修改一个错误的幻方程序</li>
</ul>
</blockquote>
<h3 id="Turtle-Graphics"><a href="#Turtle-Graphics" class="headerlink" title="Turtle Graphics"></a>Turtle Graphics</h3><blockquote>
<ul>
<li>绘制正方形</li>
<li>绘制多边形</li>
<li>绘制自己的艺术图形</li>
</ul>
</blockquote>
<h3 id="Social-Network"><a href="#Social-Network" class="headerlink" title="Social Network"></a>Social Network</h3><blockquote>
<ul>
<li>实现一个简单的数据结构存储图</li>
<li>实现最段路算法</li>
</ul>
</blockquote>
<h3 id="Tweet"><a href="#Tweet" class="headerlink" title="Tweet"></a>Tweet</h3><blockquote>
<ul>
<li>实现一条Tweet的存储，并实现按照时间筛选tweet</li>
<li>统计每个人的影响力，并进行排序</li>
</ul>
</blockquote>
<p>下面是实现过程中遇到的问题和发现的有趣现象</p>
<hr>
<h2 id="Magic-Squares-1"><a href="#Magic-Squares-1" class="headerlink" title="Magic Squares"></a>Magic Squares</h2><h3 id="1-isLegalMagicSquare"><a href="#1-isLegalMagicSquare" class="headerlink" title="1. isLegalMagicSquare"></a>1. isLegalMagicSquare</h3><p>实现思路：</p>
<ol>
<li>读入文件：使用BufferedReader按行读入文件，至EOF结束，按行处理读入数据</li>
<li>判断输入数据是否合法：若含有空格之外的空白字符，不能构成矩阵，输入的数字并不是整数等，返回false并给出提示</li>
<li>判断输入矩阵是否为幻方：按照规则检查输入矩阵每一行、每一列、主次对角线上的元素和是否相等</li>
</ol>
<h3 id="2-generateMagicSquare"><a href="#2-generateMagicSquare" class="headerlink" title="2 generateMagicSquare"></a>2 generateMagicSquare</h3><p>为原程序有如下问题<br>输入的n为偶数时，所产生的异常是访问数组所用的下标超出范围。<br>输入的n为负数时，所产生的异常是访问数组所用的下标为负数。<br>为了解决该类异常抛出,采用if语句，判断输入的n是否合法。</p>
<h2 id="Turtle-Graphics-1"><a href="#Turtle-Graphics-1" class="headerlink" title="Turtle Graphics"></a>Turtle Graphics</h2><h3 id="1-导入项目"><a href="#1-导入项目" class="headerlink" title="1. 导入项目"></a>1. 导入项目</h3><p>一开始，使用idea尝试直接打开项目，结果发现报错，之后使用eclipse尝试打开成功<br>原因是项目是按照eclipse的组织结构组织的，其中的.project文件等均是按照eclipse的格式设置，因此直接使用idea打开将会报错，但在idea中使用‘导入eclipse项目’按钮则不会发生错误</p>
<h3 id="2-Turtle-graphics-and-drawSquare"><a href="#2-Turtle-graphics-and-drawSquare" class="headerlink" title="2. Turtle graphics and drawSquare"></a>2. Turtle graphics and drawSquare</h3><p>任务需求：该任务需要我们使用turtle库中提供的函数在屏幕上画出一个正方形。<br>任务实现：通过四次循环，每次向前一个边长的距离，之后顺时针旋转九十度<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">drawSquare</span><span class="params">(Turtle turtle, <span class="keyword">int</span> sideLength)</span> </span>&#123;</span><br><span class="line">        turtle.forward(sideLength);</span><br><span class="line">        turtle.turn(<span class="number">90</span>);</span><br><span class="line">        turtle.forward(sideLength);</span><br><span class="line">        turtle.turn(<span class="number">90</span>);</span><br><span class="line">        turtle.forward(sideLength);</span><br><span class="line">        turtle.turn(<span class="number">90</span>);</span><br><span class="line">        turtle.forward(sideLength);</span><br><span class="line">        turtle.turn(<span class="number">90</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="3-Drawing-polygons"><a href="#3-Drawing-polygons" class="headerlink" title="3. Drawing polygons"></a>3. Drawing polygons</h3><p>任务需求：首先该任务需要我们实现calculateRegularPolygonAngle方法来计算多边形内角度数，之后利用该方法编写drawRegularPolygon方法画出一个<br>多边形<br>任务实现：通过多边形外角和为360度的定理计算出多边形外角的度数，之后在drawRegularPolygon方法中实现一个循环，循环边数次，每次前进之后旋转对应角度，即可画出多边形<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">drawRegularPolygon</span><span class="params">(Turtle turtle, <span class="keyword">int</span> sides, <span class="keyword">int</span> sideLength)</span> </span>&#123;</span><br><span class="line">    	<span class="keyword">double</span> turnangle=calculateRegularPolygonAngle(sides);</span><br><span class="line">    	<span class="comment">//draw each side of the regular polygon</span></span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;sides;i++) &#123;</span><br><span class="line">    		turtle.forward(sideLength);</span><br><span class="line">    		turtle.turn(<span class="number">180.0</span>-turnangle);</span><br><span class="line">    	&#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="4-Calculating-Bearings"><a href="#4-Calculating-Bearings" class="headerlink" title="4. Calculating Bearings"></a>4. Calculating Bearings</h3><p>任务需求：实现CalculatingBearings方法，根据输入的当前位置的坐标和朝向，计算为了对准目标朝向需要转过的角度。<br>任务实现：利用反三角函数，分别算出目标位置对x轴的夹角和当前朝向对x轴的夹角，之后相减即可<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">calculateBearingToPoint</span><span class="params">(<span class="keyword">double</span> currentBearing, <span class="keyword">int</span> currentX, <span class="keyword">int</span> currentY,</span></span></span><br><span class="line"><span class="function"><span class="params">                                                 <span class="keyword">int</span> targetX, <span class="keyword">int</span> targetY)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (currentX==targetX &amp;&amp; currentY==targetY) &#123;</span><br><span class="line">        	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// angle between target angle and X axis</span></span><br><span class="line">        <span class="keyword">double</span> rangle=Math.atan2(targetY-currentY,targetX-currentX);</span><br><span class="line">        <span class="keyword">double</span> pi=Math.PI;</span><br><span class="line">        <span class="keyword">double</span> degreeangle=rangle*<span class="number">180</span>/pi;</span><br><span class="line">        <span class="comment">// angle between current bearing and X axis</span></span><br><span class="line">        currentBearing=<span class="number">90</span>-currentBearing;</span><br><span class="line">        <span class="comment">// calculate the adjustment angel that needs to be done</span></span><br><span class="line">        degreeangle=currentBearing-degreeangle;</span><br><span class="line">        <span class="comment">// change it to [0,360)</span></span><br><span class="line">        <span class="keyword">while</span> (degreeangle&lt;<span class="number">0</span>) &#123;</span><br><span class="line">        	degreeangle+=<span class="number">360</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (degreeangle&gt;=<span class="number">360</span>) &#123;</span><br><span class="line">        	degreeangle-=<span class="number">360</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> degreeangle;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="Social-Network-1"><a href="#Social-Network-1" class="headerlink" title="Social Network"></a>Social Network</h2><h3 id="1-设计-实现FriendshipGraph类"><a href="#1-设计-实现FriendshipGraph类" class="headerlink" title="1. 设计/实现FriendshipGraph类"></a>1. 设计/实现FriendshipGraph类</h3><ol>
<li>FriendshipGraph类需要实现以下功能<br>a)    加点功能：支持向图中加入一个点，并能判断该点名称是否和之前的点重复<br>b)    加边功能：支持向图中加入一条边<br>c)    最段路功能：支持计算该图中任意两点间的最段路<br>实现过程：<br>FriendshipGraph类使用邻接表存储一个图，具体实现可以通过一个map和vector的嵌套<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//the link list that store the graph</span></span><br><span class="line">	<span class="keyword">private</span> Map&lt;Person,Vector&lt;Person&gt;&gt; igraph =<span class="keyword">new</span> HashMap&lt;Person,Vector&lt;Person&gt;&gt;();</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>Friendship类中各个方法实现如下<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addVertex</span><span class="params">(Person node)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (igraph.containsKey(node)) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">"The person already exits."</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// add the node to link list</span></span><br><span class="line">		igraph.put(node, <span class="keyword">new</span> Vector&lt;Person&gt;());</span><br><span class="line">		<span class="comment">// add the node to node list</span></span><br><span class="line">		nodelist.add(node);</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(Person a, Person b)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (!igraph.containsKey(a)) &#123;</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">"One person doed not exit."</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//add edge</span></span><br><span class="line">	igraph.get(a).add(b);</span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getDistance</span><span class="params">(Person s, Person e)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//distance array</span></span><br><span class="line">		Map&lt;Person,Integer&gt; dis = <span class="keyword">new</span> HashMap&lt;Person,Integer&gt;();</span><br><span class="line">		<span class="comment">//Initialize distance array, -1 represents infinity</span></span><br><span class="line">		<span class="keyword">for</span> (Person i : nodelist) &#123;</span><br><span class="line">			dis.put(i, -<span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (s==e) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//Initialize distance array, distance between s and s is 0</span></span><br><span class="line">		dis.put(s,<span class="number">0</span>);</span><br><span class="line">		<span class="comment">//bfs queue</span></span><br><span class="line">		Queue&lt;Person&gt; queue = <span class="keyword">new</span> LinkedList&lt;Person&gt;();</span><br><span class="line">		<span class="comment">//add s to queue</span></span><br><span class="line">		queue.offer(s);</span><br><span class="line">		<span class="keyword">while</span> (!queue.isEmpty()) &#123;</span><br><span class="line">			Person x=queue.element();</span><br><span class="line">			Vector&lt;Person&gt; linklist=igraph.get(x);</span><br><span class="line">			<span class="keyword">for</span> (Person i : linklist) &#123;</span><br><span class="line">				<span class="comment">// if find e</span></span><br><span class="line">				<span class="keyword">if</span> (i==e) &#123;</span><br><span class="line">					<span class="keyword">return</span> dis.get(x)+<span class="number">1</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="comment">// if current point does not be visted</span></span><br><span class="line">				<span class="keyword">if</span> (dis.get(i)==-<span class="number">1</span>) &#123;</span><br><span class="line">					<span class="comment">// calculate distance</span></span><br><span class="line">					dis.put(i, dis.get(x)+<span class="number">1</span>);</span><br><span class="line">					<span class="comment">// add to queue</span></span><br><span class="line">					queue.add(i);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//remove the front of queue</span></span><br><span class="line">			queue.remove(x);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> dis.get(e);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="2-设计-实现Person类"><a href="#2-设计-实现Person类" class="headerlink" title="2. 设计/实现Person类"></a>2. 设计/实现Person类</h3><p>实现思路<br>Person类用于存储姓名信息，并定义一带参数的构造函数应对客户端代码<br>实现过程：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	Person(String n)&#123;</span><br><span class="line">		name=n;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getname</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="Tweet-1"><a href="#Tweet-1" class="headerlink" title="Tweet"></a>Tweet</h3><h3 id="1-Extracting-data-from-tweets"><a href="#1-Extracting-data-from-tweets" class="headerlink" title="1. Extracting data from tweets"></a>1. Extracting data from tweets</h3><p>该问题需要实现:<br>任务需求：</p>
<ol>
<li>获取tweet所跨越的时间间隔</li>
<li>获取tweet所@的用户<br>实现思路：</li>
<li>扫描所有的tweet，获取时间最早的tweet和时间最晚的tweet</li>
<li>首先用空格对某一条tweet的context进行分词，之后对每一个单词进行查找，对找到@的单词进行进一步判断，若符合@规则，提取被@的用户名<br>代码如下：<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Timespan <span class="title">getTimespan</span><span class="params">(List&lt;Tweet&gt; tweets)</span> </span>&#123;</span><br><span class="line">    	Instant start=<span class="keyword">null</span>,end=<span class="keyword">null</span>;</span><br><span class="line">    	<span class="keyword">for</span> (Tweet i : tweets) &#123;</span><br><span class="line">    		<span class="comment">// if start and end haven't be Initialized, Initializing it</span></span><br><span class="line">    		<span class="keyword">if</span> (start==<span class="keyword">null</span> &amp;&amp; end==<span class="keyword">null</span>) &#123;</span><br><span class="line">    			start=i.getTimestamp();</span><br><span class="line">    			end=i.getTimestamp();</span><br><span class="line">    			<span class="keyword">continue</span>;</span><br><span class="line">    		&#125;</span><br><span class="line">    		<span class="comment">//current time stamp</span></span><br><span class="line">    		Instant now=i.getTimestamp();</span><br><span class="line">    		<span class="comment">//if start is latter than current time stamp, renew it</span></span><br><span class="line">    		<span class="keyword">if</span> (start.isAfter(now)) &#123;</span><br><span class="line">    			start=i.getTimestamp();</span><br><span class="line">    		&#125;</span><br><span class="line">    		<span class="comment">//if current time stamp is latter than end, renew it</span></span><br><span class="line">    		<span class="keyword">if</span> (now.isAfter(end)) &#123;</span><br><span class="line">    			end=now;</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	Timespan ans = <span class="keyword">new</span> Timespan(start,end);</span><br><span class="line">    	<span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Set&lt;String&gt; <span class="title">getMentionedUsers</span><span class="params">(List&lt;Tweet&gt; tweets)</span> </span>&#123;</span><br><span class="line">        Set&lt;String&gt; ans = <span class="keyword">new</span> HashSet&lt;String&gt;();</span><br><span class="line">        Set&lt;String&gt; lower = <span class="keyword">new</span> HashSet&lt;String&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Tweet i : tweets) &#123;</span><br><span class="line">        	<span class="comment">//split the tweet context and get the words list</span></span><br><span class="line">        	String[] itemp=i.getText().split(<span class="string">" "</span>);</span><br><span class="line">        	<span class="keyword">for</span> (String j : itemp) &#123;</span><br><span class="line">        		<span class="keyword">int</span> pos=j.indexOf(<span class="string">"@"</span>);</span><br><span class="line">        		<span class="comment">// if the word contains @</span></span><br><span class="line">        		<span class="keyword">if</span> (pos!=-<span class="number">1</span>) &#123;</span><br><span class="line">        			<span class="keyword">if</span> (pos==(j.length())-<span class="number">1</span>) &#123;</span><br><span class="line">        				<span class="keyword">continue</span>;</span><br><span class="line">        			&#125;</span><br><span class="line">        			<span class="comment">//judge if the prechar vaild in tweet user name</span></span><br><span class="line">        			<span class="keyword">if</span> (pos!=<span class="number">0</span>) &#123;</span><br><span class="line">        				<span class="keyword">char</span> prechar=j.charAt(pos-<span class="number">1</span>);</span><br><span class="line">        				<span class="keyword">if</span> (isvaild(prechar)) &#123;</span><br><span class="line">        					<span class="keyword">continue</span>;</span><br><span class="line">        				&#125;</span><br><span class="line">        			&#125;</span><br><span class="line">        			<span class="keyword">int</span> tail=-<span class="number">1</span>;</span><br><span class="line">        			<span class="comment">// find the last vaild user name after @</span></span><br><span class="line">        			<span class="keyword">for</span> (<span class="keyword">int</span> k=pos+<span class="number">1</span>;k&lt;j.length();k++) &#123;</span><br><span class="line">        				<span class="keyword">char</span> tempchar=j.charAt(k);</span><br><span class="line">        				<span class="keyword">if</span> (isvaild(tempchar)) &#123;</span><br><span class="line">        					tail=k;</span><br><span class="line">        				&#125;</span><br><span class="line">        				<span class="keyword">else</span> &#123;</span><br><span class="line">        					<span class="keyword">break</span>;</span><br><span class="line">        				&#125;</span><br><span class="line">        			&#125;</span><br><span class="line">        			<span class="comment">//exact the mentioned user</span></span><br><span class="line">        			<span class="keyword">if</span> (tail!=-<span class="number">1</span>) &#123;</span><br><span class="line">        				String nowusername=j.substring(pos+<span class="number">1</span>,tail+<span class="number">1</span>);</span><br><span class="line">        				<span class="keyword">if</span> (nowusername.equals(<span class="string">""</span>)) </span><br><span class="line">        					<span class="keyword">continue</span>;</span><br><span class="line">        				<span class="keyword">if</span> (lower.contains(nowusername.toLowerCase())) &#123;</span><br><span class="line">        					<span class="keyword">continue</span>;</span><br><span class="line">        				&#125;</span><br><span class="line">            			ans.add(nowusername);</span><br><span class="line">            			lower.add(nowusername.toLowerCase());</span><br><span class="line">        					</span><br><span class="line">        			&#125;</span><br><span class="line">        		&#125;</span><br><span class="line">        	&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="2-Filtering-lists-of-tweets"><a href="#2-Filtering-lists-of-tweets" class="headerlink" title="2.  Filtering lists of tweets"></a>2.  Filtering lists of tweets</h3><p>该问题需要筛选tweet，在tweet类List中筛选出符合要求的部分返回。<br>任务需求：</p>
<ol>
<li>筛选在特定时间范围内的tweet</li>
<li>筛选某一特定作者对tweet</li>
<li>筛选包含有某些特定单词的tweet<br>实现思路：<br>依次扫描每条tweet, 判断是否符合筛选条件即可<br>代码实现：<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Tweet&gt; <span class="title">writtenBy</span><span class="params">(List&lt;Tweet&gt; tweets, String username)</span> </span>&#123;</span><br><span class="line">    	List&lt;Tweet&gt; ans=<span class="keyword">new</span> ArrayList&lt;Tweet&gt;();</span><br><span class="line">    	<span class="comment">//search all tweets and get the answer</span></span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;tweets.size();i++) &#123;</span><br><span class="line">    		Tweet nowtweet=tweets.get(i);</span><br><span class="line">    		<span class="keyword">if</span> (nowtweet.getAuthor()==username) &#123;</span><br><span class="line">    			ans.add(nowtweet);</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Tweet&gt; <span class="title">inTimespan</span><span class="params">(List&lt;Tweet&gt; tweets, Timespan timespan)</span> </span>&#123;</span><br><span class="line">    	List&lt;Tweet&gt; ans=<span class="keyword">new</span> ArrayList&lt;Tweet&gt;();</span><br><span class="line">    	Instant start=timespan.getStart();</span><br><span class="line">    	Instant end=timespan.getEnd();</span><br><span class="line">    	<span class="comment">//search all tweets and get the answer</span></span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;tweets.size();i++) &#123;</span><br><span class="line">    		Tweet nowtweet=tweets.get(i);</span><br><span class="line">    		Instant nowtimestamp=nowtweet.getTimestamp();</span><br><span class="line">    		<span class="keyword">if</span> (nowtimestamp.isAfter(start) &amp;&amp; end.isAfter(nowtimestamp)) &#123;</span><br><span class="line">    			ans.add(nowtweet);</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Tweet&gt; <span class="title">containing</span><span class="params">(List&lt;Tweet&gt; tweets, List&lt;String&gt; words)</span> </span>&#123;</span><br><span class="line">    	List&lt;Tweet&gt; ans=<span class="keyword">new</span> ArrayList&lt;Tweet&gt;();</span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;words.size();i++) &#123;</span><br><span class="line">    		words.set(i, words.get(i).toLowerCase());</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">for</span> (Tweet i : tweets) &#123;</span><br><span class="line">    		<span class="comment">//change to lower case for judgment</span></span><br><span class="line">    		String[] itemp=i.getText().toLowerCase().split(<span class="string">" "</span>);</span><br><span class="line">    		<span class="keyword">boolean</span> flag=<span class="keyword">false</span>;</span><br><span class="line">    		<span class="keyword">for</span> (String j : itemp) &#123;</span><br><span class="line">    			<span class="keyword">for</span> (String k : words) &#123;</span><br><span class="line">    				<span class="keyword">if</span> (j.equals(k)) &#123;</span><br><span class="line">    					flag=<span class="keyword">true</span>;</span><br><span class="line">    					<span class="keyword">break</span>;</span><br><span class="line">    				&#125;</span><br><span class="line">    			&#125;</span><br><span class="line">    		&#125;</span><br><span class="line">    		<span class="keyword">if</span> (flag) &#123;</span><br><span class="line">    			ans.add(i);</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="3-Inferring-a-social-network"><a href="#3-Inferring-a-social-network" class="headerlink" title="3. Inferring a social network"></a>3. Inferring a social network</h3><p>任务需求：</p>
<ol>
<li>通过tweet内容猜测用户之间的follow关系</li>
<li>通过用户之间的follow关系统计影响力，并将用户按照影响力排名<br>实现思路：</li>
<li>某一用户@的用户必然是其关注的用户</li>
<li>根据第一条准则，统计计算影响力，并将用户按照影响力排名<br>代码实现：<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, Set&lt;String&gt;&gt; guessFollowsGraph(List&lt;Tweet&gt; tweets) &#123;</span><br><span class="line">    	Map&lt;String,Set&lt;String&gt;&gt; ans = <span class="keyword">new</span> HashMap&lt;String,Set&lt;String&gt;&gt;();</span><br><span class="line">    	Map&lt;String,Set&lt;String&gt;&gt; theme = <span class="keyword">new</span> HashMap&lt;String,Set&lt;String&gt;&gt;();</span><br><span class="line">    	Extract getat= <span class="keyword">new</span> Extract();</span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;tweets.size();i++) &#123;</span><br><span class="line">    		Tweet nowtweet=tweets.get(i);</span><br><span class="line">    		String nowauthor=nowtweet.getAuthor();</span><br><span class="line">    		List&lt;Tweet&gt; nowlist = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    		Set&lt;String&gt; nowat = <span class="keyword">new</span> HashSet&lt;String&gt;();</span><br><span class="line">    		nowlist.add(nowtweet);</span><br><span class="line">    		nowat=getat.getMentionedUsers(nowlist);</span><br><span class="line">    		<span class="keyword">if</span> (nowat.isEmpty())</span><br><span class="line">    			<span class="keyword">continue</span>;</span><br><span class="line">    		<span class="keyword">if</span> (!ans.containsKey(nowauthor)) &#123;</span><br><span class="line">    			ans.put(nowauthor,nowat);</span><br><span class="line">    		&#125;</span><br><span class="line">    		<span class="keyword">for</span> (String j : nowat) &#123;</span><br><span class="line">    			<span class="keyword">if</span> (ans.get(nowauthor).contains(j)) &#123;</span><br><span class="line">    				<span class="keyword">continue</span>;</span><br><span class="line">    			&#125;</span><br><span class="line">    			ans.get(nowauthor).add(j);</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, Set&lt;String&gt;&gt; MyguessFollowsGraph(List&lt;Tweet&gt; tweets) &#123;</span><br><span class="line">    	Map&lt;String,Set&lt;String&gt;&gt; ans = <span class="keyword">new</span> HashMap&lt;String,Set&lt;String&gt;&gt;();</span><br><span class="line">    	Map&lt;String,Set&lt;String&gt;&gt; theme = <span class="keyword">new</span> HashMap&lt;String,Set&lt;String&gt;&gt;();</span><br><span class="line">    	Extract getat= <span class="keyword">new</span> Extract();</span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;tweets.size();i++) &#123;</span><br><span class="line">    		Tweet nowtweet=tweets.get(i);</span><br><span class="line">    		String nowauthor=nowtweet.getAuthor();</span><br><span class="line">    		List&lt;Tweet&gt; nowlist = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    		Set&lt;String&gt; nowat = <span class="keyword">new</span> HashSet&lt;String&gt;();</span><br><span class="line">    		nowlist.add(nowtweet);</span><br><span class="line">    		nowat=getat.getMentionedUsers(nowlist);</span><br><span class="line">    		<span class="keyword">if</span> (nowat.isEmpty())</span><br><span class="line">    			<span class="keyword">continue</span>;</span><br><span class="line">    		<span class="keyword">if</span> (!ans.containsKey(nowauthor)) &#123;</span><br><span class="line">    			ans.put(nowauthor,nowat);</span><br><span class="line">    		&#125;</span><br><span class="line">    		<span class="keyword">for</span> (String j : nowat) &#123;</span><br><span class="line">    			<span class="keyword">if</span> (ans.get(nowauthor).contains(j)) &#123;</span><br><span class="line">    				<span class="keyword">continue</span>;</span><br><span class="line">    			&#125;</span><br><span class="line">    			ans.get(nowauthor).add(j);</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;tweets.size();i++) &#123;</span><br><span class="line">    		Tweet nowtweet=tweets.get(i);</span><br><span class="line">    		String nowauthor=nowtweet.getAuthor();</span><br><span class="line">    		List&lt;Tweet&gt; nowlist = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    		Set&lt;String&gt; nowtheme = <span class="keyword">new</span> HashSet&lt;String&gt;();</span><br><span class="line">    		nowlist.add(nowtweet);</span><br><span class="line">    		nowtheme=getat.getTheme(nowlist);</span><br><span class="line">    		<span class="keyword">if</span> (nowtheme.isEmpty())</span><br><span class="line">    			<span class="keyword">continue</span>;</span><br><span class="line">    		<span class="keyword">if</span> (!theme.containsKey(nowauthor)) &#123;</span><br><span class="line">    			theme.put(nowauthor,nowtheme);</span><br><span class="line">    		&#125;</span><br><span class="line">    		<span class="keyword">for</span> (String j : nowtheme) &#123;</span><br><span class="line">    			<span class="keyword">if</span> (theme.get(nowauthor).contains(j)) &#123;</span><br><span class="line">    				<span class="keyword">continue</span>;</span><br><span class="line">    			&#125;</span><br><span class="line">    			theme.get(nowauthor).add(j);</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">for</span> (String i : theme.keySet())</span><br><span class="line">    		<span class="keyword">for</span> (String j : theme.keySet()) &#123;</span><br><span class="line">    			<span class="keyword">if</span> (i.equals(j)) &#123;</span><br><span class="line">    				<span class="keyword">continue</span>;</span><br><span class="line">    			&#125;</span><br><span class="line">    			Set&lt;String&gt; tempSet=theme.get(i);</span><br><span class="line">    			tempSet.retainAll(theme.get(j));</span><br><span class="line">    			<span class="keyword">if</span> (!tempSet.isEmpty()) &#123;</span><br><span class="line">    				ans.get(i).add(j);</span><br><span class="line">    				ans.get(j).add(i);</span><br><span class="line">    			&#125;</span><br><span class="line">    		&#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Find the people in a social network who have the greatest influence, in</span></span><br><span class="line"><span class="comment">     * the sense that they have the most followers.</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> followsGraph</span></span><br><span class="line"><span class="comment">     *            a social network (as defined above)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> a list of all distinct Twitter usernames in followsGraph, in</span></span><br><span class="line"><span class="comment">     *         descending order of follower count.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title">influencers</span><span class="params">(Map&lt;String, Set&lt;String&gt;&gt; followsGraph)</span> </span>&#123;</span><br><span class="line">        Map&lt;String, Integer&gt; followernumber = <span class="keyword">new</span> HashMap&lt;String, Integer&gt;();</span><br><span class="line">        <span class="keyword">for</span> (String i : followsGraph.keySet()) &#123;</span><br><span class="line">        	Set&lt;String&gt; followerSet = <span class="keyword">new</span> HashSet&lt;String&gt;();</span><br><span class="line">        	followerSet=followsGraph.get(i);</span><br><span class="line">        	<span class="keyword">for</span> (String j : followerSet) &#123;</span><br><span class="line">        		<span class="keyword">if</span> (!followernumber.containsKey(j)) &#123;</span><br><span class="line">        			followernumber.put(j, <span class="number">1</span>);</span><br><span class="line">        			<span class="keyword">continue</span>;</span><br><span class="line">        		&#125;</span><br><span class="line">        		Integer nownumber=followernumber.get(j);</span><br><span class="line">        		followernumber.put(j, nownumber+<span class="number">1</span>);</span><br><span class="line">        	&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        List&lt;Map.Entry&lt;String, Integer&gt;&gt; list = <span class="keyword">new</span> ArrayList&lt;Map.Entry&lt;String, Integer&gt;&gt;(followernumber.entrySet());</span><br><span class="line">        Collections.sort(list, <span class="keyword">new</span> Comparator&lt;Map.Entry&lt;String, Integer&gt;&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Map.Entry&lt;String, Integer&gt; mapping1, Map.Entry&lt;String, Integer&gt; mapping2)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> mapping2.getValue().compareTo(mapping1.getValue());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        Iterator&lt;Map.Entry&lt;String, Integer&gt;&gt; iter = list.iterator();</span><br><span class="line">        Map.Entry&lt;String, Integer&gt; tmpEntry = <span class="keyword">null</span>;</span><br><span class="line">        List&lt;String&gt; ans=<span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">        <span class="keyword">while</span> (iter.hasNext()) &#123;</span><br><span class="line">        	tmpEntry = iter.next();</span><br><span class="line">        	ans.add(tmpEntry.getKey());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/author5.jpg" alt="zeromaker">
            
              <p class="site-author-name" itemprop="name">zeromaker</p>
              <p class="site-description motion-element" itemprop="description">Existentialism is a Humanism</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zeromaker</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
